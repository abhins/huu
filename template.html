<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8"> 
<style type="text/css">

body {
    font-family: 'CiscoSansTT-Thin',sans-serif;
    height: 100%;
    font-size: .8em;
}

.table-fixed {
	background-color: #f3f3f3;
}

.table-fixed {
	border-collapse: collapse;
}

td {
	border: .2px solid black;
	text-align: left;
	padding: 15px;
}

th {
	border: 1px solid black;
	text-align: left;
	padding: 15px;
	bgcolor="#004BAF";
	color=white;
    font-size: 120%;
}

#marker {
	text-align:center;
	
}

.header {
    background-color: #004BAF;
}

h1  {
    margin:0;
    padding: 10px;
    font-family: 'CiscoSansTT-Thin',sans-serif;
    font-size: 2em;
    color: #ffffff;
    font-weight: normal;
}

.dataTables_filter {
    margin: 0 0 10px 0;
}

table.dataTable.stripe tbody tr.odd, table.dataTable.display tbody tr.odd {
    background-color: #E8EBF1 !important;
}

.example{
    font-size: .8em;
}

.no {
color:red;
font-size:1.38em;
}

.yes    {
    color:green;
    font-size:1.38em;
}

.no-border-right {
    border-right:none;
    background-color:#C6DDF2 !important;
}
.no-border-left {
    border-left: none;
    background-color:#C6DDF2 !important;
}

table.dataTable thead th, table.dataTable thead td {
    background-color:#00A9E7 !important;
}





a {
    cursor: pointer;
    color: #3174c7;
    text-decoration: none;
}

#columnIds {
    margin-top: 10px;
}

.red {
    color:red;
}


#colSelectionSpan > a.toggle-vis.hiddenCol , #colSelectionSpan_unique> a.toggle-vis.hiddenCol {
    color: #fd4141;
    border-color: #fd4141;
}
#colSelectionSpan > a , #colSelectionSpan_unique > a{
    margin: 5px;
    cursor: pointer;
    padding: 5px;
    background: #fff;
    color: #4CAF50;
    border-radius: 5px;
    border: #4CAF50 solid 2px;
    line-height: 2.5em;
}

.DTFC_LeftBodyLiner {
    overflow-y: hidden !important;
}

#colSelectionSpan {
width:0px;
height:0px;
}


    
</style>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/fixedcolumns/3.2.6/css/fixedColumns.dataTables.min.css">

<script src="https://code.jquery.com/jquery-3.3.1.js"></script>
<script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/fixedcolumns/3.2.6/js/dataTables.fixedColumns.min.js"></script>
</head>

<body>
<div class="header">
<h1>UCS C-Series Rack-Mount Standalone Server Software Comparison</h1>
</div>



{% set ns = namespace() %}
{% set ns.totalReleases = 0 %}
{% set ns.platPerRelease = 0 %}
{% set ns.total_cols = 0 %}
{% set ns.i = 0 %}


<div id="colSelectionSpan" style="visibility:hidden"></div>
<div id="colSelectionSpan_unique"></div>


<div id="js_table"></div>

<table id="example" style="display:none">
<thead>

    
    
<!-- Table header start -->
<tr>
 
<th colspan="3"     style="text-align: right;"></th>
{% for keys1 in header|dictsort(reverse=true) %}
	{% set ns.totalReleases = ns.totalReleases + 1 %}
		{% set ns.platPerRelease = 0 %}
{% for keys2 in header[keys1[0]]|dictsort %}
			{% set ns.platPerRelease = ns.platPerRelease +1  %}
		{% endfor %}
   
	<th colspan="{{ ns.platPerRelease }}"> {{ keys1[0] }}  </th>
{% endfor %}
</tr>
<tr>

<th>Component</th>
<th>Description</th>
<th>Firmware</th>
{% for keys1 in header|dictsort(reverse=true) %}
	{% set ns.totalReleases = ns.totalReleases + 1 %}
		{% set ns.platPerRelease = 0 %}
		{% for keys2 in header[keys1[0]]|dictsort %}
			{% set ns.platPerRelease = ns.platPerRelease +1  %}
			{% set ns.total_cols = ns.total_cols +1  %}
		<th>{{ keys2[0] }}</th>
		{% endfor %}
{% endfor %}
</tr>

<!-- Table header end -->


        
</thead>



{% for component in rData|dictsort %}
	
        <tr>
              
            <td style="font-weight: bold;" bgcolor="#C6DDF2" > {{ component[0] }} </td>
            <td class="no-border-right no-border-left" > </td>
            <td class="no-border-right no-border-left" data-attr-class="no-border-right no-border-left">  </td>
            {% for keys1 in header|dictsort(reverse=true) %}
                {% set ns.totalReleases = ns.totalReleases + 1 %}
                {% set ns.platPerRelease = 0 %}
                {% for keys2 in header[keys1[0]]|dictsort %}
                    {% set ns.platPerRelease = ns.platPerRelease +1  %}
                    {% set ns.total_cols = ns.total_cols +1  %}
                    <td class="no-border-right no-border-left" data-attr-class="no-border-right no-border-left"> </td>
                {% endfor %}
            {% endfor %}
        </tr>
		{% for rowElem in component[1] %}
            <tr>
			{% set ns.i = 0 %}
			{% for cell in rowElem %}
				{% if ns.i < 4 %}
                    {% if ns.i == 1 %}
                        {% if rowElem[0] == 'N' %}
                            <td > {{ cell }} </td>                    
                         {% else %}
                            <td > {{ cell }} <span class="red">*</span> </td>
                         {% endif %}
                    {% else %}
                        {% if ns.i != 0 %}
                         <td > {{ cell }}  </td>
                         {% endif %}
                    {% endif %}
				{% else  %}
                
                     {% if cell == 'N' %}
                        <td id="marker" class="no"> &times;</td>
                     {% else  %}
                        <td id="marker" class="yes"> {{ '&#10003' }} </td>
                    {% endif %}
				{% endif %}
				{% set ns.i = ns.i +1  %}
			{% endfor  %}
            </tr>
		{% endfor %}
	
{% endfor %}

</tbody>

</table>
<script>

var data ={{rData}}

var theadofhtml="<tr> <th colspan=1 style=text-align: right;></th> {% for keys1 in header|dictsort(reverse=true) %} 	{% set ns.totalReleases = ns.totalReleases + 1 %} 	{% set ns.platPerRelease = 0 %} {% for keys2 in header[keys1[0]]|dictsort %}  			{% set ns.platPerRelease = ns.platPerRelease +1  %}  	{% endfor %}  <th colspan={{ ns.platPerRelease }}> {{ keys1[0] }}  </th> {% endfor %} </tr>"
var theadofhtml2="<tr> <th>Component</th> {% for keys1 in header|dictsort(reverse=true) %} 	{% set ns.totalReleases = ns.totalReleases + 1 %} 		{% set ns.platPerRelease = 0 %} 		{% for keys2 in header[keys1[0]]|dictsort %} 			{% set ns.platPerRelease = ns.platPerRelease +1  %} 			{% set ns.total_cols = ns.total_cols +1  %} 		<th>{{ keys2[0] }}</th>  	{% endfor %} {% endfor %} </tr>"
var js_table_dummy_td=" {% for keys1 in header|dictsort(reverse=true) %} 	{% set ns.totalReleases = ns.totalReleases + 1 %} 		{% set ns.platPerRelease = 0 %} 		{% for keys2 in header[keys1[0]]|dictsort %} 			{% set ns.platPerRelease = ns.platPerRelease +1  %} 			{% set ns.total_cols = ns.total_cols +1  %} 		<td class=no-border-right no-border-left ></td>  	{% endfor %} {% endfor %} "
console.log("theadofhtml "+theadofhtml)


$(document).ready(function() {
    
    
    
     nwComponents = {}
 
 for (component in data){
   
     
     console.log("component : "+component)
     console.log("Lets try data[component] : "+ data[component])
     //console.log("Lets try  : "+ typeof(data[component]))
    // console.log("Lets try  : "+data[component].length);
     nwComponents[component] ={}
     if (data[component]) {
        
        
        i=1;
        //data[component] 
        console.log("sorted :"+data[component].sort())
         for (release in  data[component].sort()) {
           
            console.log(component+" release : "+data[component][release])
            
            if (data[component][release][1] in nwComponents[component]){
                console.log(i+" Lets try ++"+data[component][release][1])
                
              //  nwComponents[component][data[component][release][1]+"_count"]=i;
                
                for (comp_applicable in data[component][release]) {
                    if (comp_applicable > 3) {
                    console.log("comp_applicable "+data[component][release][comp_applicable])
                        if (data[component][release][comp_applicable] == "Y") {
                        
                                
                        
                           
                            console.log("just testing")
                            nwComponents[component][data[component][release][1]][0][comp_applicable]=data[component][release][3]
                           
                        
                        }
                 
                        
                    }
                }
                
             i++   
                //break;
            }else {
                i=1;
                console.log("Lets try "+i+" "+data[component][release][1])
               // nwComponents[component][data[component][release][1]+"_count"]=i;
                nwComponents[component][data[component][release][1]] = []
                nwComponents[component][data[component][release][1]].push(data[component][release])
                for (comp_applicable in data[component][release]) {
                 console.log("comp_applicable "+data[component][release][comp_applicable])
                 index=3
                 if (comp_applicable > 3) {
                        if (data[component][release][comp_applicable] == "Y") {
                        
                                
                        
                           
                           // console.log("just testing 2")
                           console.log( "just testing 2" +nwComponents[component][data[component][release][1]]+ " "+comp_applicable)
                            console.log( "just testing 2" +nwComponents[component][data[component][release][1]][0])
                            //var index = items.indexOf(3452);

                            //if (index !== -1) {
                                //items[index] = 1010;
                                 nwComponents[component][data[component][release][1]][0][comp_applicable]=data[component][release][3]
                            //}
                           
                           
                        
                        } 
                 
                 }   
                 index++;
                }
                //i++
                i=2
            }
            
         }
     }
 
 }
 console.log("final components")
 console.log( JSON.stringify(nwComponents))
 
 
 js_table_html="<table id='example1'>"
 js_table_html+="<thead>"
 js_table_html+=theadofhtml
 js_table_html+=theadofhtml2
  js_table_html+="</thead>"
// th_count=10;
 //js_table_dummy_td=''
 //for (th_c=0;th_c<th_count; th_c++ ){
 //js_table_dummy_td+="<td></td>"
 //}
 
 /*for (th_c=0;th_c<=th_count; th_c++ ){
 
  
  js_table_html+="<th>"+th_c+"</th>"
 }
 js_table_html+="</thead>"
 */
 js_table_html+="<tbody>"

 for (com in nwComponents){
  js_table_html+="<tr>"
 js_table_html+="<td style=font-weight: bold; bgcolor =#C6DDF2 >"+com+"</td>"+js_table_dummy_td
    
     js_table_html+="</tr>"
   console.log(JSON.stringify(nwComponents[com]))
   

    for (items in nwComponents[com]) {
        js_table_html+="<tr>"
        
     
    
   
        
        for (item in nwComponents[com][items]) {
            for (i in nwComponents[com][items][item]) {
            
            if (i==0){
                if (com == "HDD") {
                
                    if(nwComponents[com][items][item][0] != "N") {
           
                        js_table_html+="<td >"+nwComponents[com][items][item][2]+"  <span class=red>*</span>  <span style=opacity:0;width:0px;height:0px;display: block;>"+com+"</span></td>"
                    } else {
                        js_table_html+="<td >"+nwComponents[com][items][item][2]+"  <span style=opacity:0;width:0px;height:0px;display: block;>"+com+"</span></td>"
                    }
   
                }
                 if (com != "HDD") {
                 
                     if(nwComponents[com][items][item][0] != "N") {
           
                        js_table_html+="<td  >"+items+" <span class=red>*</span> <span style=opacity:0;width:0px;height:0px;display: block;>"+com+"</span></td>"
                        } else {
                        js_table_html+="<td >"+items+"   <span style=opacity:0;width:0px;height:0px;display: block;>"+com+"</span></td>"
                     }
   
                }
            }
    
                if (i>3) {
                    if (nwComponents[com][items][item][i] =="N"){
                    js_table_html+="<td id=marker class=no>&times</td>"
                    
                    } else {
                        js_table_html+="<td >"+nwComponents[com][items][item][i]+"</td>"
                    }
                }
            }
        }
        
        js_table_html+="</tr>"
    
    }
 
 
   
    
 }
 js_table_html+="</tbody>"
js_table_html+="</table>"


console.log(js_table_html)
$("#js_table").html(js_table_html)


function showdatatable() {     
    var table = $('#example1').DataTable( {
        scrollY:        "340px",
        //scrollX:        true,
        
        scrollX:        true,
        ScrollX: "100%", 
        ScrollCollapse: true,
        ScrollXInner: "400%", 
        paging:         false,
        "ordering": false,

        fixedColumns:   {
            leftColumns: 1
        }
    } );
 }

 
    
    
    setTimeout(showdatatable, 2000)

 /*var table = $('#example').DataTable( {
        scrollY:        "340px",
        //scrollX:        true,
        
        scrollX:        true,
        ScrollX: "100%", 
        ScrollCollapse: true,
        ScrollXInner: "400%", 
        paging:         false,
        "ordering": false,

        fixedColumns:   {
            leftColumns: 3
        }
    } );
    
    

    
    var columns = table.columns().header();
     
    
    console.log(columns)
    console.log(typeof(columns))

    columnsHtml ='Toggle column: ';
    var columns_names=[]
    i=0;
    for ( k in columns){
        console.log(columns[k].innerText +"  "+ columns[k].cellIndex )
        if (typeof(columns[k].cellIndex) == 'number'){
        colno = columns[k].cellIndex.toString();
        console.log(colno )
        console.log(typeof(colno ))
        columnsHtml += '<a class="toggle-visa" data-column='+colno+'>'+columns[k].innerText+'</a>'
        columns_names.push(columns[k].innerText)
        
        i++;
        
        console.log(i )
        console.log(columns.length )
        if ( i != columns.length) {
            columnsHtml += ' - '
        }
        console.log(columnsHtml )
         
       }
      
    }
    $("#colSelectionSpan").html(columnsHtml)
    console.log("unique(columns_names)" )
    console.log(unique(columns_names) )
    columns_names_unique = unique(columns_names)
    
    unique_columnsHtml ='Toggle column release: ';
    for ( colname in columns_names_unique){
    unique_columnsHtml+= '<a class="toggle-vis" >'+columns_names_unique[colname]+'</a>'
    }
     $("#colSelectionSpan_unique").html(unique_columnsHtml)
    
    function unique(list) {
    var result = [];
    $.each(list, function(i, e) {
        if ($.inArray(e, result) == -1) result.push(e);
    });
    return result;
}


    
     $('a.toggle-vis').on( 'click', function (e) {
        e.preventDefault();
         var that = this;
         var my = $(this);
        
        $( "#colSelectionSpan a" ).each(function( index ) {
  
  if ($( this ).text() == my.text()){
  console.log( index + ": " + $( this ).text() );
   var column =  table.column(index)
    column.visible( ! column.visible() );
  }
  
  //table.columns.adjust().draw( false ); 
});
        
       
table.columns.adjust().draw( false );         
   
        
        console.log($(this).text())
       
        if ($(this).hasClass("hiddenCol")){
        $(this).removeClass("hiddenCol")
         table.column($(this).text()).visible(true);
        }else {
         table.column($(this).text()).visible(false);
        $(this).addClass("hiddenCol")
        }
        
 } );*/
} );
</script>
</body>
</html>
